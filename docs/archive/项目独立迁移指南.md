# 🚀 Price-Suite 项目独立迁移指南

## 📋 为什么要独立这个项目？

### 当前问题
```
shopxo-master/
├── app/                   # ShopXO（PHP/ThinkPHP）
├── plugins/               # ShopXO插件
├── composer.json          # PHP依赖
└── apps/
    └── price-suite/       # ❌ Python项目混在PHP项目里
        ├── server/        # Python Flask
        ├── client/        # Python GUI
        └── rpa/           # Python自动化
```

### 存在的问题
- ❌ **上下文混淆**：AI助手会混淆两个完全不同的项目
- ❌ **依赖冲突**：PHP的composer.json vs Python的requirements.txt
- ❌ **路径错误**：终端默认在shopxo-master根目录
- ❌ **Git管理困难**：两个项目应该有独立的版本控制
- ❌ **部署复杂**：两个项目部署环境完全不同

### 独立后的好处
- ✅ **专注开发**：Cursor只关注一个项目，AI理解更准确
- ✅ **路径正确**：终端、文件搜索都在正确的根目录
- ✅ **Git清晰**：独立的提交历史、分支管理
- ✅ **部署简单**：独立部署、独立CI/CD
- ✅ **团队协作**：可以独立分享、独立授权

---

## 🎯 项目对比

| 特性 | ShopXO | Price-Suite |
|------|--------|-------------|
| **语言** | PHP | Python |
| **框架** | ThinkPHP 6 | Flask |
| **用途** | 电商系统 | 智能选品工具 |
| **数据库** | MySQL | SQLite |
| **前端** | Vue.js | CustomTkinter (桌面GUI) |
| **部署** | 宝塔/Apache/Nginx | Flask服务器 + exe客户端 |
| **依赖管理** | Composer | pip |
| **是否关联** | ❌ **完全无关** | ❌ **完全无关** |

**结论：两个项目技术栈、业务逻辑完全独立，应该分开管理！**

---

## 📦 迁移步骤（完整版）

### 步骤1：备份当前项目

```bash
# 备份整个目录
cd /home/user/projects
cp -r shopxo-master/apps/price-suite ~/backups/price-suite-backup-$(date +%Y%m%d)

# 或者压缩备份
tar -czf ~/backups/price-suite-$(date +%Y%m%d).tar.gz shopxo-master/apps/price-suite
```

### 步骤2：移动到独立目录

```bash
# 创建独立项目目录
mkdir -p /home/user/projects/price-suite

# 移动所有文件
mv /home/user/projects/shopxo-master/apps/price-suite/* \
   /home/user/projects/price-suite/

# 验证文件已移动
ls -la /home/user/projects/price-suite/
```

### 步骤3：初始化独立Git仓库

```bash
cd /home/user/projects/price-suite

# 如果已有.git目录（从apps/price-suite带过来的）
# 检查远程仓库
git remote -v

# 如果没有.git目录，初始化
git init
git add .
git commit -m "Initial commit: 智能选品铺货系统独立迁移"

# 关联远程仓库（如果已有）
git remote add origin https://github.com/zhiqiangsun2025-droid/price-suite.git
git branch -M main
git push -u origin main
```

### 步骤4：创建项目根配置文件

#### 创建 `.gitignore`
```bash
cat > /home/user/projects/price-suite/.gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
venv/
env/
ENV/
.venv

# IDE
.vscode/
.idea/
*.swp
*.swo
.DS_Store

# 日志和数据库
*.log
*.db
*.sqlite
*.sqlite3

# 临时文件
tmp/
temp/
*.tmp

# RPA截图
rpa/screenshots/
rpa/templates/*.png

# 打包文件
dist/
build/
*.spec

# 敏感信息
.env
config_local.py
*.key
*.pem
EOF
```

#### 创建根目录 `README.md`
```bash
# 已有README.md，确保内容完整
cat /home/user/projects/price-suite/README.md
```

#### 创建 `.cursorrules`（可选，优化AI理解）
```bash
cat > /home/user/projects/price-suite/.cursorrules << 'EOF'
# Price-Suite 项目说明

这是一个智能选品铺货系统，由三个独立模块组成：

1. **server/** - Flask后端服务器
   - 爬取抖音/淘宝商品
   - AI匹配拼多多同款
   - 客户端授权管理
   
2. **client/** - Python桌面客户端
   - CustomTkinter现代化GUI
   - 加密通信
   - 打包为Windows exe
   
3. **rpa/** - 桌面自动化
   - PyAutoGUI自动化
   - 图像识别
   - 自动铺货

## 技术栈
- Python 3.8+
- Flask (后端)
- CustomTkinter (客户端UI)
- Selenium (爬虫)
- PyAutoGUI (RPA)

## 重要提示
- 这是一个完整的商业化产品
- 包含防破解机制（硬件绑定、加密通信）
- 客户端需打包为exe分发
EOF
```

### 步骤5：配置虚拟环境

#### 服务器端
```bash
cd /home/user/projects/price-suite/server

# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt

# 测试启动
python app.py
```

#### 客户端（在Windows上操作）
```batch
cd C:\path\to\price-suite\client

# 创建虚拟环境
python -m venv venv

# 激活
venv\Scripts\activate

# 安装依赖
pip install -r requirements_modern.txt

# 测试运行
python modern_client_v10.10.3.py
```

### 步骤6：更新配置文件

#### 服务器端配置
```bash
# 编辑 server/app.py，确认配置
nano /home/user/projects/price-suite/server/app.py

# 检查以下配置：
# - 端口号（默认5000）
# - 数据库路径
# - 日志路径
# - CORS配置
```

#### 客户端配置
```python
# 编辑 client/modern_client_v10.10.3.py
# 更新服务器地址为实际部署地址
SERVER_URL = "http://你的服务器IP:5000"
```

### 步骤7：在Cursor中打开新工作区

#### 方法1：通过命令行
```bash
# 关闭当前Cursor窗口
# 然后打开新目录
cursor /home/user/projects/price-suite
```

#### 方法2：通过Cursor界面
```
1. 点击 File → Open Folder
2. 导航到 /home/user/projects/price-suite
3. 点击 Select Folder
```

#### 方法3：添加到工作区（多项目）
```
1. File → Add Folder to Workspace
2. 选择 /home/user/projects/price-suite
3. 现在可以在一个窗口管理多个项目
```

### 步骤8：验证迁移成功

#### 检查清单
```bash
cd /home/user/projects/price-suite

# ✅ 目录结构完整
ls -la
# 应该看到：server/ client/ rpa/ README.md 等

# ✅ Git仓库正常
git status
git remote -v

# ✅ Python环境正常
cd server
source venv/bin/activate
python -c "import flask; print('Flask OK')"

# ✅ 依赖安装完整
pip list | grep -E 'flask|selenium|pillow'

# ✅ 服务器可以启动
python app.py
# 访问 http://localhost:5000 应该能看到响应
```

---

## 📁 迁移后的目录结构

### 独立项目结构
```
/home/user/projects/
│
├── shopxo-master/              # 工作区1：ShopXO电商系统
│   ├── app/
│   ├── plugins/
│   ├── composer.json
│   └── .git/
│
└── price-suite/                # 工作区2：智能选品系统（独立）
    ├── server/                 # Flask后端
    │   ├── app.py
    │   ├── ai_matcher.py
    │   ├── requirements.txt
    │   └── venv/
    │
    ├── client/                 # Python GUI客户端
    │   ├── modern_client_v10.10.3.py
    │   ├── encryption.py
    │   ├── build_windows.bat
    │   ├── requirements_modern.txt
    │   └── venv/
    │
    ├── rpa/                    # 自动化脚本
    │   ├── rpa_controller.py
    │   ├── templates/
    │   └── requirements.txt
    │
    ├── README.md               # 项目说明
    ├── .gitignore              # Git忽略文件
    ├── .cursorrules            # Cursor项目配置
    ├── DEPLOY.md               # 部署文档
    ├── SECURITY_GUIDE.md       # 安全指南
    └── .git/                   # 独立Git仓库
```

---

## 🔧 Cursor工作区配置

### 创建工作区配置文件

```bash
# 创建 .vscode/settings.json（Cursor兼容）
mkdir -p /home/user/projects/price-suite/.vscode

cat > /home/user/projects/price-suite/.vscode/settings.json << 'EOF'
{
  "python.defaultInterpreterPath": "server/venv/bin/python",
  "python.linting.enabled": true,
  "python.linting.pylintEnabled": true,
  "python.formatting.provider": "black",
  "editor.formatOnSave": true,
  "files.exclude": {
    "**/__pycache__": true,
    "**/*.pyc": true,
    "**/.venv": true,
    "**/venv": true
  },
  "search.exclude": {
    "**/venv": true,
    "**/node_modules": true,
    "**/__pycache__": true
  }
}
EOF
```

---

## 🚀 开发工作流

### 日常开发流程

#### 1. 服务器端开发
```bash
# 打开Cursor
cursor /home/user/projects/price-suite

# 在终端中
cd server
source venv/bin/activate
python app.py

# 开发完成后
git add .
git commit -m "feat: 新增功能"
git push
```

#### 2. 客户端开发（Windows）
```batch
# 打开Cursor（Windows版）
# 在终端中
cd client
venv\Scripts\activate
python modern_client_v10.10.3.py

# 测试完成后打包
build_windows.bat

# 提交代码
git add .
git commit -m "feat: 客户端更新"
git push
```

#### 3. RPA开发
```bash
cd rpa
python rpa_controller.py

# 截图模板
# 将按钮截图保存到 templates/ 目录
```

---

## 🔄 与ShopXO的关系

### 完全独立，互不影响

```
✅ 可以同时开发两个项目
✅ 可以同时运行两个项目  
✅ 可以部署到不同服务器
✅ 可以给不同团队维护

两个项目的唯一联系：
- 都在 /home/user/projects/ 下
- 仅此而已
```

---

## 📊 迁移前后对比

| 项目 | 迁移前 | 迁移后 |
|------|--------|--------|
| **路径** | `/projects/shopxo-master/apps/price-suite` | `/projects/price-suite` |
| **Cursor根目录** | shopxo-master（错误） | price-suite（正确） |
| **AI上下文** | 混淆PHP和Python | 专注Python项目 |
| **终端路径** | 需要手动cd到子目录 | 直接在根目录 |
| **Git管理** | 混在shopxo的git里 | 独立Git仓库 |
| **依赖管理** | composer和pip混淆 | 纯pip管理 |
| **部署** | 困难（两个项目混合） | 简单（独立部署） |

---

## ✅ 迁移验证清单

完成迁移后，逐项检查：

### 文件系统
- [ ] price-suite目录已移动到 `/home/user/projects/price-suite`
- [ ] 所有文件完整（server/client/rpa目录都在）
- [ ] 文档完整（README.md、各种指南.md）
- [ ] 原shopxo-master/apps/price-suite目录已删除或清空

### Git仓库
- [ ] `.git` 目录存在
- [ ] `git status` 正常运行
- [ ] `git remote -v` 显示正确的远程仓库
- [ ] 可以正常 `git pull` 和 `git push`

### Python环境
- [ ] server/venv 虚拟环境已创建
- [ ] `source venv/bin/activate` 可以激活
- [ ] `pip list` 显示所有依赖已安装
- [ ] `python app.py` 可以启动服务器

### Cursor工作区
- [ ] Cursor打开的是 price-suite 根目录（不是shopxo-master）
- [ ] 左侧文件树显示 server/client/rpa 等目录
- [ ] 终端路径是 `/home/user/projects/price-suite`
- [ ] AI助手理解上下文正确（测试问一个price-suite相关问题）

### 功能测试
- [ ] 服务器可以启动（`python server/app.py`）
- [ ] 访问 http://localhost:5000 有响应
- [ ] 管理后台可以访问
- [ ] 客户端可以运行（Windows环境）
- [ ] 可以打包exe（`build_windows.bat`）

---

## 🎯 下一步行动

迁移完成后，建议立即做：

### 1. 测试完整流程
```bash
# 启动服务器
cd /home/user/projects/price-suite/server
source venv/bin/activate
python app.py

# 在另一个终端测试API
curl http://localhost:5000/api/health
```

### 2. 更新文档中的路径
```bash
# 检查所有md文档，更新路径引用
cd /home/user/projects/price-suite
grep -r "shopxo-master" *.md
# 将找到的路径更新为新路径
```

### 3. 配置CI/CD
```yaml
# .github/workflows/build-windows.yml
# 确认GitHub Actions配置正确
```

### 4. 通知团队成员
```
如果有团队成员，通知他们：
1. 项目已迁移到新路径
2. 需要重新克隆仓库
3. 更新本地开发环境
```

---

## 🆘 常见问题

### Q1: 迁移后原来的shopxo-master/apps/price-suite怎么处理？
```bash
# 确认新位置一切正常后，删除旧目录
rm -rf /home/user/projects/shopxo-master/apps/price-suite

# 或者保留作为备份（重命名）
mv /home/user/projects/shopxo-master/apps/price-suite \
   /home/user/projects/shopxo-master/apps/price-suite.old
```

### Q2: 如果需要同时开发两个项目怎么办？
```
方法1: 开两个Cursor窗口
- 窗口1: /home/user/projects/shopxo-master
- 窗口2: /home/user/projects/price-suite

方法2: 使用Cursor工作区（Workspace）
- File → Add Folder to Workspace
- 同时添加两个项目文件夹
```

### Q3: 虚拟环境需要重新创建吗？
```bash
# 如果原来的venv也迁移过来了，可以继续用
# 但推荐重新创建（更干净）
cd /home/user/projects/price-suite/server
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### Q4: Git提交历史会丢失吗？
```
不会！只要 .git 目录一起迁移过来，
所有提交历史、分支、标签都会保留。

验证：
git log --oneline
git branch -a
```

### Q5: 如何在Cursor中快速切换项目？
```
方法1: File → Open Recent
方法2: Ctrl+R (快速打开最近项目)
方法3: 命令行：cursor /path/to/project
```

---

## 📞 需要帮助？

如果迁移过程中遇到问题：

1. **检查备份**：确保备份完整，可以随时回滚
2. **查看日志**：检查错误日志，定位问题
3. **逐步验证**：按照清单逐项检查
4. **寻求帮助**：描述具体错误信息

---

## 🎉 迁移完成

完成所有步骤后，你将拥有：

✅ **一个干净独立的项目**
✅ **正确的开发环境配置**
✅ **清晰的Git版本控制**
✅ **高效的开发工作流**

**现在可以专注于 Price-Suite 的开发了！** 🚀

---

## 附录：快速命令参考

```bash
# 激活服务器虚拟环境
cd /home/user/projects/price-suite/server && source venv/bin/activate

# 启动服务器
python app.py

# 查看日志
tail -f app.log

# 提交代码
git add . && git commit -m "更新说明" && git push

# 打包客户端（Windows）
cd client && build_windows.bat

# 测试RPA
cd rpa && python rpa_controller.py

# 在Cursor中打开项目
cursor /home/user/projects/price-suite
```

---

**文档版本**: v1.0  
**更新日期**: 2025-01-12  
**作者**: AI Assistant  
**适用项目**: Price-Suite 智能选品铺货系统

