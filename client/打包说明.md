# 📦 客户端打包方案

## 方案对比

### 🥇 方案A：一体化打包（推荐）

**打包内容**:
```
智能选品系统.exe  (单文件，50-80MB)
├── 客户端UI
├── RPA脚本（内置）
└── 所有依赖
```

**优点**:
- ✅ 客户只需要一个文件
- ✅ 双击运行，无需安装
- ✅ 不会弄混

**缺点**:
- ❌ 文件稍大（但可接受）

---

### 🥈 方案B：分离打包

**打包内容**:
```
智能选品系统.exe     (客户端，20MB)
RPA工具.exe          (RPA，30MB)
```

**优点**:
- ✅ 文件小

**缺点**:
- ❌ 客户需要下载两个文件
- ❌ 容易搞混
- ❌ 路径问题

---

## ✅ 推荐方案A：一体化打包

### 打包脚本

创建 `build_all_in_one.bat`:

```batch
@echo off
echo ========================================
echo 智能选品系统 - 一体化打包
echo ========================================

REM 1. 安装所有依赖
echo [1/3] 安装依赖...
pip install -r requirements_modern.txt
pip install pyautogui pywinauto opencv-python

REM 2. 打包（包含RPA）
echo [2/3] 打包中...
pyinstaller --onefile ^
    --windowed ^
    --name="智能选品系统" ^
    --icon=app.ico ^
    --add-data="../rpa/rpa_controller.py;rpa" ^
    --add-data="../rpa/templates;rpa/templates" ^
    --hidden-import=customtkinter ^
    --hidden-import=PIL ^
    --hidden-import=pandas ^
    --hidden-import=pyautogui ^
    --hidden-import=pywinauto ^
    --clean ^
    modern_client.py

REM 3. 完成
echo [3/3] 打包完成！
echo 输出: dist\智能选品系统.exe
pause
```

### 客户端调用RPA（内置版）

修改 `modern_client.py`:

```python
import sys
import os
import subprocess

def start_listing(self):
    """一键铺货"""
    try:
        # 先导出Excel
        if not hasattr(self, 'last_excel_path'):
            self.export_to_excel()
        
        # 获取RPA脚本路径（打包后）
        if getattr(sys, 'frozen', False):
            # 打包后的exe
            base_path = sys._MEIPASS
            rpa_script = os.path.join(base_path, 'rpa', 'rpa_controller.py')
        else:
            # 开发环境
            rpa_script = os.path.join(os.path.dirname(__file__), '..', 'rpa', 'rpa_controller.py')
        
        # 调用RPA
        subprocess.Popen([
            sys.executable if not getattr(sys, 'frozen', False) else 'python',
            rpa_script,
            '--excel', self.last_excel_path,
            '--column', '抖音链接'
        ])
        
        messagebox.showinfo("提示", "RPA已启动，请勿操作鼠标键盘！\n窗口会自动最小化到后台")
    
    except Exception as e:
        messagebox.showerror("错误", f"启动RPA失败: {str(e)}")
```

---

## 交付清单

### 给客户的文件（方案A）

```
📁 智能选品系统_v1.0/
├── 智能选品系统.exe        ← 主程序（一体化）
├── 使用说明.pdf            ← 操作手册
└── 激活码.txt              ← 客户端ID（管理员提供）
```

### 给客户的文件（方案B）

```
📁 智能选品系统_v1.0/
├── 智能选品系统.exe        ← 客户端
├── RPA工具/
│   ├── RPA工具.exe
│   └── templates/          ← 按钮图片模板（需要客户截图）
├── 使用说明.pdf
└── 激活码.txt
```

---

## 客户操作流程

### 1. 首次安装（方案A）

```
Step 1: 解压 智能选品系统_v1.0.zip
Step 2: 双击 智能选品系统.exe
Step 3: 输入激活信息:
        - 服务器地址: http://你的服务器IP:5000
        - 客户端ID: (激活码.txt中提供)
Step 4: 激活成功，开始使用
```

### 2. 日常使用

```
Step 1: 双击 智能选品系统.exe
Step 2: 输入选品条件
Step 3: 点击"开始智能选品"（等待5-10分钟）
Step 4: 查看结果 → 点击"导出Excel"
Step 5: 点击"一键铺货"（RPA自动启动）
```

---

## FAQ

**Q: 客户需要安装Python吗？**
A: ❌ 不需要！exe已经包含所有依赖。

**Q: 客户需要配置RPA吗？**
A: ✅ 需要！首次使用需要截图按钮位置（保存到templates/）

**Q: 能在多台电脑上用吗？**
A: ❌ 不能！有硬件绑定，复制到其他电脑会激活失败。

**Q: 如何更新版本？**
A: 下载新的exe，覆盖旧文件即可（配置会保留）。

---

## 推荐：方案A一体化打包！

**理由**:
- 客户体验最好（一个文件搞定）
- 不会搞混RPA和客户端
- 文件大小可接受（50-80MB）

