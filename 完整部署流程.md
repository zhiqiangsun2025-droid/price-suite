# 🚀 完整部署流程（一图看懂）

## 📋 部署清单

### 1️⃣ 服务器端（你的服务器）

```
宝塔面板部署（推荐）:
───────────────────────────────────────────
1. 安装Python项目管理器
2. 上传 server/ 文件夹到 /www/wwwroot/price-suite/
3. 创建Python项目：
   - 启动文件: app.py
   - 端口: 5000
   - 进程数: 4
4. 安装依赖: pip install -r requirements.txt
5. 启动服务
6. 配置反向代理（可选）: api.yourdomain.com
7. 申请SSL证书（可选）

✅ 完成后访问: https://api.yourdomain.com/admin/login
```

**或者手动部署**:
```bash
cd /www/wwwroot/price-suite/server
pip3 install -r requirements.txt
python3 app.py
```

---

### 2️⃣ 客户端打包（给客户）

#### 方案A：一体化打包（推荐）

```batch
REM Windows电脑上执行
cd client/

REM 1. 安装依赖
pip install -r requirements_modern.txt
pip install pyautogui pywinauto opencv-python

REM 2. 打包（包含RPA）
pyinstaller --onefile --windowed ^
    --name="智能选品系统" ^
    --icon=app.ico ^
    --add-data="../rpa/rpa_controller.py;rpa" ^
    --add-data="../rpa/templates;rpa/templates" ^
    modern_client.py

REM 3. 产物
dist/智能选品系统.exe  ← 这就是给客户的文件
```

**交付给客户**:
```
📁 智能选品系统_v1.0/
├── 智能选品系统.exe        ← 主程序
├── 使用说明.pdf
└── 激活码.txt              ← 包含客户端ID
```

---

### 3️⃣ 客户使用流程

#### 首次使用:

```
Step 1: 解压文件
Step 2: 双击 智能选品系统.exe
Step 3: 输入激活信息
        - 服务器地址: https://api.yourdomain.com
        - 客户端ID: (从激活码.txt获取)
Step 4: 激活成功
```

#### 日常使用:

```
┌─────────────────────────────────────────┐
│ 1. 双击启动程序                          │
│    智能选品系统.exe                       │
└─────────────────────────────────────────┘
                ↓
┌─────────────────────────────────────────┐
│ 2. 输入选品条件                          │
│    类目: 女装/连衣裙                     │
│    时间段: 近7天                         │
│    数量: 50                              │
│    价差: 30%                             │
│    销量增长: 20%                         │
└─────────────────────────────────────────┘
                ↓
┌─────────────────────────────────────────┐
│ 3. 点击"开始智能选品"                    │
│                                          │
│    进度显示（带动画）:                   │
│    ⭕ → 🔄 → ✅                          │
│                                          │
│    🔗 连接服务器          ✅             │
│    🔍 搜索抖音商品        ✅             │
│    🤖 AI智能匹配          ✅             │
│    💰 价格对比分析        ✅             │
│    ✅ 完成                ✅             │
│                                          │
│    等待时间: 5-10分钟                    │
└─────────────────────────────────────────┘
                ↓
┌─────────────────────────────────────────┐
│ 4. 查看结果                              │
│                                          │
│  序号 | 商品标题 | 抖音价 | 拼多多 | 价差│
│  ─────────────────────────────────────  │
│   1   | 连衣裙.. | ¥128  | ¥59   |53.9%│
│   2   | T恤...  | ¥89   | ¥35   |60.7%│
│   ...                                    │
└─────────────────────────────────────────┘
                ↓
┌─────────────────────────────────────────┐
│ 5. 导出Excel                             │
│    点击"📊 导出Excel"按钮                │
│                                          │
│    保存位置:                             │
│    C:\Users\xxx\Desktop\选品结果.xlsx   │
└─────────────────────────────────────────┘
                ↓
┌─────────────────────────────────────────┐
│ 6. 一键铺货（可选）                      │
│    点击"🚀 一键铺货"按钮                 │
│                                          │
│    RPA自动启动:                          │
│    - 打开铺货软件                        │
│    - 逐个输入抖音链接                    │
│    - 自动点击铺货                        │
│    - 完成后导出结果                      │
│                                          │
│    ⚠️ 期间请勿操作鼠标键盘！             │
└─────────────────────────────────────────┘
```

---

### 4️⃣ 虚拟机部署（推荐）

#### Windows用户:

```
物理主机 (Windows)
├── 正常工作（Word/Excel/游戏等）
└── VMware Workstation Player（免费）
    └── Windows 10 虚拟机
        ├── 智能选品系统.exe
        ├── 铺货软件
        └── Chrome浏览器

配置:
- CPU: 2核
- 内存: 4GB
- 硬盘: 60GB（动态分配）

开机自启动 ✅
后台运行 ✅
不占用主机鼠标键盘 ✅
```

#### Linux服务器:

```
Linux服务器
├── Flask服务器（主机）
└── KVM虚拟机（或云Windows实例）
    └── Windows 10
        ├── 智能选品系统.exe
        ├── 铺货软件
        └── RPA自动工作

访问方式:
- VNC远程桌面
- 或云桌面（阿里云无影）
```

---

## 🎯 进度条效果展示

### UI进度步骤（带动画）

```
开始时（全灰色）:
⭕ 连接服务器    ⭕ 搜索商品    ⭕ AI匹配    ⭕ 价格对比    ⭕ 完成

步骤1（蓝色旋转）:
🔄 连接服务器    ⭕ 搜索商品    ⭕ AI匹配    ⭕ 价格对比    ⭕ 完成

步骤2（绿色✅，下一步蓝色旋转）:
✅ 连接服务器    🔄 搜索商品    ⭕ AI匹配    ⭕ 价格对比    ⭕ 完成

步骤3:
✅ 连接服务器    ✅ 搜索商品    🔄 AI匹配    ⭕ 价格对比    ⭕ 完成

步骤4:
✅ 连接服务器    ✅ 搜索商品    ✅ AI匹配    🔄 价格对比    ⭕ 完成

完成（全绿色）:
✅ 连接服务器    ✅ 搜索商品    ✅ AI匹配    ✅ 价格对比    ✅ 完成

进度条: ████████████████████ 100%
提示: ✅ 完成！找到 15 个符合条件的商品
```

---

## 📊 数据流向（完整版）

```
┌─────────────┐
│   客户端    │  收集参数
│   (UI)      │  - 类目: 女装
│             │  - 时间: 近7天
└──────┬──────┘  - 数量: 50
       │         - 价差: 30%
       │ HTTP POST
       ↓
┌─────────────┐
│   服务器    │  无头浏览器爬取
│  (Flask)    │  ┌─────────────┐
│             │→ │ Selenium    │ → 抖音
│             │  │ (headless)  │ → 拼多多
│             │  └─────────────┘
│             │
│             │  AI匹配
│             │  ┌─────────────┐
│             │→ │TF-IDF + 图片│
│             │  │ 哈希        │
│             │  └─────────────┘
│             │
│             │  计算
│             │  - 销量增长: 43%
│             │  - 价差: 53.9%
│             │  - 相似度: 87%
└──────┬──────┘
       │ JSON返回
       ↓
┌─────────────┐
│   客户端    │  显示结果
│   (UI)      │  （不做任何计算）
└──────┬──────┘
       │ 导出Excel
       ↓
┌─────────────┐
│ 桌面Excel   │
│ 选品结果    │  包含"抖音链接"列
│ .xlsx       │
└──────┬──────┘
       │ RPA读取
       ↓
┌─────────────┐
│    RPA      │  读Excel → 逐个铺货
│  (本地)     │  （不联网）
└─────────────┘
```

---

## ❓ 常见问题速查

| 问题 | 答案 |
|------|------|
| **宝塔部署Flask** | ✅ 推荐！Python项目管理器一键部署 |
| **客户端和RPA合并** | ✅ 推荐！打包成一个exe |
| **进度条动画** | ✅ 已实现！5步骤带旋转动画 |
| **虚拟机必须吗** | ✅ 强烈推荐！不影响主机工作 |
| **Linux能跑RPA** | ❌ 不能！必须Windows |
| **Excel在哪生成** | 客户端本地（不经过服务器） |
| **服务器返回什么** | JSON（计算好的数据） |
| **RPA需要联网** | ❌ 不需要！读本地Excel |

---

## 📝 部署检查清单

### 服务器端 ✅

- [ ] 宝塔面板安装Python项目管理器
- [ ] 上传server文件夹
- [ ] 创建Python项目（端口5000）
- [ ] 安装依赖（requirements.txt）
- [ ] 启动服务
- [ ] 测试访问 /api/health
- [ ] 配置反向代理（可选）
- [ ] 申请SSL证书（可选）

### 客户端打包 ✅

- [ ] 安装PyInstaller
- [ ] 安装所有依赖
- [ ] 准备图标文件（app.ico）
- [ ] 执行打包脚本
- [ ] 测试exe是否能运行
- [ ] 检查文件大小（50-80MB）
- [ ] 准备使用说明.pdf

### 客户使用 ✅

- [ ] 解压文件
- [ ] 双击exe
- [ ] 输入服务器地址和客户端ID
- [ ] 激活成功
- [ ] 测试选品功能
- [ ] 导出Excel
- [ ] 测试RPA（如需要）

### 虚拟机（可选）✅

- [ ] 安装VMware/VirtualBox
- [ ] 下载Windows 10 ISO
- [ ] 创建虚拟机（2核4GB）
- [ ] 安装Windows系统
- [ ] 安装选品系统
- [ ] 配置自动启动
- [ ] 测试后台运行

---

## 🎉 完成！

部署完成后，你将拥有：

1. ✅ **服务器**: 宝塔面板管理，24小时运行
2. ✅ **客户端**: 单文件exe，双击即用
3. ✅ **进度条**: 漂亮的5步动画
4. ✅ **虚拟机**: 后台运行，不影响工作
5. ✅ **防破解**: 多层保护，核心逻辑在服务器

**文档齐全**:
- 宝塔面板部署指南.md
- 客户端打包说明.md
- 虚拟机部署指南.md
- 数据流向详解.md
- 前后端分工清单.md
- README_简明版.md

有任何问题，随时查阅文档！🚀



