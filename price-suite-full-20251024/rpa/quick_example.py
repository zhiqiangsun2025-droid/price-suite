#!/usr/bin/env python3
"""
å¿«é€Ÿå¼€å§‹ç¤ºä¾‹ - 5åˆ†é’Ÿä¸Šæ‰‹ RPA
"""

import pyautogui
import time

print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ¤– Windows æ¡Œé¢è‡ªåŠ¨åŒ– - å¿«é€Ÿç¤ºä¾‹                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è¿™ä¸ªè„šæœ¬å°†æ¼”ç¤ºå¦‚ä½•ï¼š
1. è‡ªåŠ¨æ‰“å¼€è®°äº‹æœ¬
2. è‡ªåŠ¨è¾“å…¥æ–‡å­—
3. è‡ªåŠ¨ä¿å­˜æ–‡ä»¶

5ç§’åå¼€å§‹...ï¼ˆå°†é¼ æ ‡ç§»åˆ°å·¦ä¸Šè§’å¯ç´§æ€¥åœæ­¢ï¼‰
""")

time.sleep(5)

# ==================== ç¤ºä¾‹1ï¼šæ‰“å¼€è®°äº‹æœ¬ ====================

print("\n[1/5] æ‰“å¼€è®°äº‹æœ¬...")

# æ–¹æ³•1ï¼šä½¿ç”¨ Win + R è¿è¡Œ
pyautogui.hotkey('win', 'r')  # æ‰“å¼€"è¿è¡Œ"å¯¹è¯æ¡†
time.sleep(0.5)

pyautogui.typewrite('notepad', interval=0.1)  # è¾“å…¥ notepad
pyautogui.press('enter')  # å›è½¦
time.sleep(1)

print("âœ… è®°äº‹æœ¬å·²æ‰“å¼€")

# ==================== ç¤ºä¾‹2ï¼šè¾“å…¥æ–‡å­— ====================

print("\n[2/5] è¾“å…¥æ–‡å­—...")

# è‹±æ–‡ï¼ˆç›´æ¥è¾“å…¥ï¼‰
pyautogui.typewrite('Hello, this is RPA automation!', interval=0.05)
pyautogui.press('enter')
pyautogui.press('enter')

# ä¸­æ–‡ï¼ˆä½¿ç”¨ç²˜è´´ï¼‰
import pyperclip

chinese_text = """
è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•ï¼

åŠŸèƒ½å±•ç¤ºï¼š
1. è‡ªåŠ¨æ‰“å¼€åº”ç”¨ç¨‹åº
2. è‡ªåŠ¨è¾“å…¥æ–‡å­—ï¼ˆä¸­è‹±æ–‡ï¼‰
3. è‡ªåŠ¨ä¿å­˜æ–‡ä»¶
4. è‡ªåŠ¨å…³é—­ç¨‹åº

ç”Ÿæˆæ—¶é—´ï¼š""" + time.strftime('%Y-%m-%d %H:%M:%S')

pyperclip.copy(chinese_text)
pyautogui.hotkey('ctrl', 'v')

print("âœ… æ–‡å­—å·²è¾“å…¥")

# ==================== ç¤ºä¾‹3ï¼šæˆªå›¾ ====================

print("\n[3/5] æˆªå›¾ä¿å­˜...")

screenshot = pyautogui.screenshot()
screenshot.save('notepad_screenshot.png')

print("âœ… æˆªå›¾å·²ä¿å­˜: notepad_screenshot.png")

# ==================== ç¤ºä¾‹4ï¼šä¿å­˜æ–‡ä»¶ ====================

print("\n[4/5] ä¿å­˜æ–‡ä»¶...")

# Ctrl + S ä¿å­˜
pyautogui.hotkey('ctrl', 's')
time.sleep(0.5)

# è¾“å…¥æ–‡ä»¶å
filename = 'rpa_test_' + time.strftime('%Y%m%d_%H%M%S') + '.txt'
pyautogui.typewrite(filename, interval=0.05)
time.sleep(0.3)

# å›è½¦ä¿å­˜
pyautogui.press('enter')
time.sleep(0.5)

print(f"âœ… æ–‡ä»¶å·²ä¿å­˜: {filename}")

# ==================== ç¤ºä¾‹5ï¼šå…³é—­è®°äº‹æœ¬ ====================

print("\n[5/5] å…³é—­è®°äº‹æœ¬...")

# Alt + F4 å…³é—­
pyautogui.hotkey('alt', 'F4')
time.sleep(0.3)

print("âœ… è®°äº‹æœ¬å·²å…³é—­")

# ==================== å®Œæˆ ====================

print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   âœ… è‡ªåŠ¨åŒ–æ¼”ç¤ºå®Œæˆï¼                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä½ å·²ç»å­¦ä¼šäº†åŸºç¡€çš„RPAæ“ä½œï¼š
âœ… æ‰“å¼€ç¨‹åº
âœ… è¾“å…¥æ–‡å­—ï¼ˆè‹±æ–‡å’Œä¸­æ–‡ï¼‰
âœ… æˆªå›¾
âœ… ä¿å­˜æ–‡ä»¶
âœ… å…³é—­ç¨‹åº

ä¸‹ä¸€æ­¥ï¼š
1. æŸ¥çœ‹ rpa_controller.py äº†è§£å®Œæ•´åŠŸèƒ½
2. æŸ¥çœ‹ README_RPA.md äº†è§£è¯¦ç»†æ–‡æ¡£
3. å¼€å§‹è‡ªåŠ¨åŒ–ä½ çš„é“ºè´§è½¯ä»¶ï¼

""")

# ==================== è¿›é˜¶ç¤ºä¾‹ï¼šå›¾åƒè¯†åˆ« ====================

print("=" * 60)
print("ğŸ“ è¿›é˜¶åŠŸèƒ½æ¼”ç¤º")
print("=" * 60)

demo_choice = input("\næ˜¯å¦æ¼”ç¤ºå›¾åƒè¯†åˆ«åŠŸèƒ½ï¼Ÿ(y/n): ")

if demo_choice.lower() == 'y':
    print("\nå‡†å¤‡ä¸­...")
    print("å³å°†æ¼”ç¤ºå¦‚ä½•æŸ¥æ‰¾å±å¹•ä¸Šçš„å›¾æ ‡...")
    
    time.sleep(2)
    
    # æˆªå–æ¡Œé¢
    print("\n1. æˆªå–å½“å‰æ¡Œé¢...")
    desktop = pyautogui.screenshot()
    desktop.save('desktop.png')
    
    # è·å–å±å¹•å°ºå¯¸
    screen_width, screen_height = pyautogui.size()
    print(f"   å±å¹•åˆ†è¾¨ç‡: {screen_width} x {screen_height}")
    
    # é¼ æ ‡å½“å‰ä½ç½®
    x, y = pyautogui.position()
    print(f"   é¼ æ ‡ä½ç½®: ({x}, {y})")
    
    # è·å–é¼ æ ‡ä½ç½®çš„é¢œè‰²
    pixel_color = pyautogui.pixel(x, y)
    print(f"   é¼ æ ‡å¤„é¢œè‰²: RGB{pixel_color}")
    
    print("\nğŸ’¡ æç¤ºï¼š")
    print("   - ç§»åŠ¨é¼ æ ‡å¯ä»¥è·å–ä»»æ„ä½ç½®åæ ‡")
    print("   - ä½¿ç”¨ pyautogui.click(x, y) ç‚¹å‡»æŒ‡å®šä½ç½®")
    print("   - ä½¿ç”¨å›¾åƒæ¨¡æ¿å¯ä»¥æ™ºèƒ½è¯†åˆ«æŒ‰é’®ä½ç½®")

print("\n" + "=" * 60)
print("ğŸ‘¨â€ğŸ’» å®æˆ˜ç»ƒä¹ å»ºè®®")
print("=" * 60)
print("""
1. ç»ƒä¹ 1ï¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨å¹¶è®¿é—®ç½‘ç«™
   pyautogui.hotkey('win', 'r')
   pyautogui.typewrite('chrome https://www.baidu.com')
   pyautogui.press('enter')

2. ç»ƒä¹ 2ï¼šè‡ªåŠ¨å¤åˆ¶ç²˜è´´
   pyautogui.hotkey('ctrl', 'c')  # å¤åˆ¶
   pyautogui.hotkey('ctrl', 'v')  # ç²˜è´´

3. ç»ƒä¹ 3ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªé“ºè´§è‡ªåŠ¨åŒ–
   - æ‰‹åŠ¨æ‰“å¼€é“ºè´§è½¯ä»¶
   - è®°å½•æ¯ä¸ªæ­¥éª¤çš„åæ ‡
   - ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬

å¼€å§‹å§ï¼ğŸš€
""")

